<div class="notification is-light is-info has-text-centered mb-6">
  <strong>üí° Tip:</strong> Buying multiple tickets increases your odds ‚Äî view active raffles below.
</div>

<div class="section raffles-index" style="background-color: #f9fafb;">
  <div class="container">

    <!-- Hero Header -->
    <div class="has-text-centered mb-6">
      <h1 class="title is-2 mb-6  ">üéüÔ∏è Current Raffles</h1>
      <p class="subtitle is-5 has-text-grey">
        Enter raffles for the latest gadgets, collectibles, and more ‚Äî starting from just $1 per ticket.
      </p>
    </div>

    <div class="field has-addons has-addons-centered mb-6" style=" margin: 0 auto;">
      <div class="control is-expanded">
        <input class="input is-medium" type="text" placeholder="Search raffles (e.g. iPhone, PS5, sneakers)">
      </div>
      <div class="control">
        <a class="button is-medium is-primary" style="font-weight:600;">Search</a>
      </div>
    </div>


    <!-- Category Filter Bar -->
    <div class="buttons are-small is-centered mb-6">
      <button class="button is-light is-rounded is-active">All</button>
      <button class="button is-light is-rounded">Tech</button>
      <button class="button is-light is-rounded">Audio</button>
      <button class="button is-light is-rounded">Fashion</button>
      <button class="button is-light is-rounded">Home</button>
    </div>

    <!-- Raffle Grid -->
    <% if @raffles.present? %>
      <div class="columns is-multiline">
        <% @raffles.each do |raffle| %>
          <div class="column is-one-third-desktop is-half-tablet">
            <div class="raffle-card card p-0" style="transition: all 0.2s ease-in-out;">
              <div class="card-image">
                <% if raffle.images.attached? %>
                  <figure class="image is-3by2">
                    <%= image_tag url_for(raffle.images.first), alt: raffle.name %>
                  </figure>
                <% else %>
                  <figure class="image is-3by2">
                    <%= image_tag "https://community.softr.io/uploads/db9110/original/2X/7/74e6e7e382d0ff5d7773ca9a87e6f6f8817a68a6.jpeg", alt: raffle.name %>
                  </figure>
                <% end %>
              </div>

              <div class="card-content">
                <p class="title is-5 mb-1"><%= raffle.name %></p>
                <p class="has-text-weight-semibold is-size-6 mb-2">$<%= raffle.ticket_price %> per ticket</p>
                <p class="is-size-7 has-text-grey mb-4">
                  <%= truncate(raffle.description.to_plain_text, length: 80) %>
                </p>

                <!-- Stats Row -->
                <div class="level is-mobile mb-2">
                  <div class="level-left">
                    <p class="is-size-7 has-text-grey">üéüÔ∏è 182 sold</p>
                  </div>
                  <div class="level-right">
                    <p class="is-size-7 has-text-grey">‚è∞ 2d left</p>
                  </div>
                </div>

                <!-- View Details Button -->
                <%= link_to "View Details", raffle_path(raffle),
                            class: "button is-light is-fullwidth mt-2",
                            style: "color:#4f46e5; font-weight:600;" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <!-- Empty State -->
      <div class="has-text-centered py-6">
        <p class="is-size-5 has-text-grey-dark mb-2">No raffles available right now</p>
        <p class="is-size-6 has-text-grey">Check back soon ‚Äî new items are added daily.</p>
        <% if user_signed_in? %>
          <%= link_to "Create one now", new_raffle_path, class: "button is-primary is-rounded mt-4" %>
        <% end %>
      </div>
    <% end %>
    <p class="has-text-centered is-size-6 has-text-grey mt-5">
      Over <strong>124</strong> active raffles ¬∑ <strong>2,300</strong> tickets sold today
    </p>
    <!-- Pagination -->
    <nav class="pagination is-centered mt-6" role="navigation" aria-label="pagination">
      <ul class="pagination-list">
        <li><a class="pagination-link is-current" aria-label="Page 1">1</a></li>
        <li><a class="pagination-link">2</a></li>
        <li><a class="pagination-link">3</a></li>
        <li><span class="pagination-ellipsis">&hellip;</span></li>
        <li><a class="pagination-link">10</a></li>
      </ul>
    </nav>

    <% if user_signed_in? %>
      <a href="<%= new_raffle_path %>"
         class="button is-primary is-medium"
         style="position: fixed; bottom: 2rem; right: 2rem; border-radius: 50%;">
         +
      </a>
    <% end %>

    <p class="has-text-centered is-size-7 has-text-grey mt-2">
      Showing 1‚Äì9 of 24 raffles
    </p>
    <div class="has-text-centered mt-6">
      <p class="is-size-7 has-text-grey">
        Platform total: <strong>$12,430 raised</strong> ¬∑ <strong>5,300 tickets</strong> sold across all raffles
      </p>
    </div>


  </div>
</div>

<style>
  .button.is-primary:hover { filter: brightness(1.1); }
.tabs a:hover { background-color: #f1f5f9; }

.raffle-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
}
.button.is-rounded.is-active {
  background-color: #4f46e5;
  color: #fff;
  font-weight: 600;
}
.input.is-medium {
  border-radius: 9999px;
  border-color: #e5e7eb;
  box-shadow: 0 1px 3px rgba(0,0,0,0.03);
}

.input.is-medium:focus {
  border-color: #4f46e5;
  box-shadow: 0 0 0 0.2em rgba(79,70,229,0.15);
}

.button.is-primary {
  border-radius: 9999px;
  background-color: #4f46e5;
  font-weight: 600;
  transition: all 0.2s ease;
}

.button.is-primary:hover {
  background-color: #4338ca;
}

.pagination a,
.pagination span {
  border-radius: 8px;
}

.pagination-link.is-current {
  background-color: #4f46e5;
  border-color: #4f46e5;
  color: #fff;
  font-weight: 600;
}

.pagination-link:hover {
  border-color: #4f46e5;
  color: #4f46e5;
}

.pagination-previous,
.pagination-next {
  font-weight: 500;
  color: #4f46e5;
}

.raffle-card:hover .card-image::after {
  bottom: 0;
  left: 0;
  width: 100%;
  background: rgba(79,70,229,0.9);
  color: #fff;
  text-align: center;
  padding: 0.5rem 0;
  font-weight: 600;
}

.raffle-card {
  opacity: 0;
  transform: translateY(10px);
  animation: fadeUp 1s ease forwards;
}
@keyframes fadeUp {
  to { opacity: 1; transform: translateY(0); }
}
</style>

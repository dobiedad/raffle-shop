<section class="section user-profile" style="background-color:#f8f9fb; min-height:100vh;">
  <div class="container">

    <div class="box has-text-centered" style="padding:3rem 2rem; border-radius:14px;">
      <div class="mb-3" style="display: inline-block;">
        <%= image_tag user_avatar_url(@user), alt: "Profile photo", style: "width: 128px; height: 128px; border-radius: 50%; border: 3px solid #4f46e5; object-fit: cover;" %>
      </div>

      <h1 class="title is-4 mb-1"><%= @user.email %></h1>
      <p class="is-size-7 has-text-grey mb-2">
        Member since <strong><%= @user.created_at.strftime("%B %Y") %></strong>
      </p>

      <div class="tags is-centered mb-4">
        <span class="tag is-light is-info">Verified</span>
        <span class="tag is-light is-success">Active</span>
      </div>

      <div class="buttons is-centered">
        <%= link_to "Edit Profile", edit_user_registration_path, class: "button is-primary is-small" %>
        <%= link_to "My Raffles", my_created_raffles_path, class: "button is-light is-small" %>
      </div>
    </div>

    <div class="columns is-multiline mt-6">

      <div class="column is-one-third">
        <div class="box has-text-centered" style="border-radius:12px;">
          <h2 class="title is-6 mb-3">🎟️ Tickets Entered</h2>
          <p class="is-size-3 has-text-weight-semibold"><%= @tickets_entered_count %></p>
        </div>
      </div>

      <div class="column is-one-third">
        <div class="box has-text-centered" style="border-radius:12px;">
          <h2 class="title is-6 mb-3">💰 Total Spent</h2>
          <p class="is-size-3 has-text-weight-semibold">$<%= number_with_precision(@total_spent, precision: 2) %></p>
        </div>
      </div>

      <div class="column is-one-third">
        <div class="box has-text-centered" style="border-radius:12px;">
          <h2 class="title is-6 mb-3">🏆 Raffles Won</h2>
          <p class="is-size-3 has-text-weight-semibold"><%= @raffles_won_count %></p>
        </div>
      </div>

      <div class="column is-half">
        <div class="box" style="border-radius:12px;">
          <div class="is-flex is-justify-content-space-between is-align-items-center">
            <div>
              <h2 class="title is-6 mb-2">Wallet Balance</h2>
              <p class="is-size-4 has-text-weight-semibold">$<%= number_with_precision(@wallet_balance, precision: 2) %></p>
            </div>
            <div class="buttons">
              <%= link_to "Add Funds", "#", class: "button is-primary is-small", onclick: "alert('Add funds feature coming soon!'); return false;" %>
              <%= link_to "Withdraw", "#", class: "button is-light is-small", onclick: "alert('Withdraw feature coming soon!'); return false;" %>
            </div>
          </div>
        </div>
      </div>

      <div class="column is-half">
        <div class="box" style="border-radius:12px;">
          <h2 class="title is-6 mb-3">Achievements</h2>
          <div class="tags">
            <%= render_achievements(@user) %>
          </div>
        </div>
      </div>

      <div class="column is-full">
        <div class="box" style="border-radius:12px;">
          <h2 class="title is-6 mb-4">Recent Activity</h2>

          <% if @recent_activities.present? %>
            <table class="table is-fullwidth is-hoverable is-size-7">
              <tbody>
                <% @recent_activities.each do |activity| %>
                  <tr>
                    <td><%= activity[:description] %></td>
                    <td class="has-text-right has-text-grey"><%= activity[:time_ago] %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
            <%= link_to "View Full History", "#", class: "has-text-link is-size-7" %>
          <% else %>
            <div class="has-text-centered py-5">
              <p class="has-text-grey">No recent activity</p>
              <p class="is-size-7 has-text-grey mt-2">
                Your ticket purchases and raffle entries will appear here
              </p>
            </div>
          <% end %>
        </div>
      </div>

    </div>

  </div>
</section>

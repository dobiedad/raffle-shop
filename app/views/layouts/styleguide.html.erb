<!DOCTYPE html>
<html>
  <head>
    <title>Component Styleguide - Raffle Shop</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <style>
      body {
        margin: 0;
        padding: 0;
      }

      .styleguide-container {
        display: flex;
        min-height: 100vh;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #f5f5f5;
      }

      .styleguide-sidebar {
        width: 250px;
        min-width: 250px;
        flex-shrink: 0;
        background: #ffffff;
        border-right: 1px solid #e0e0e0;
        padding: 24px;
        overflow-y: auto;
      }

      @media (max-width: 768px) {
        .styleguide-sidebar {
          display: none;
        }
      }

      .styleguide-sidebar-header {
        margin-bottom: 16px;
      }

      .styleguide-main {
        flex: 1;
        padding: 40px;
        background: #f5f5f5;
        min-width: 0;
        overflow-x: auto;
        margin-left: 0;
        transition: margin-left 0.3s ease;
      }

      @media (max-width: 768px) {
        .styleguide-main {
          padding: 20px;
        }
      }

      .styleguide-main h1 {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 24px;
        color: #333;
      }

      .styleguide-sidebar h2 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 16px;
        color: #333;
      }

      .styleguide-sidebar ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .styleguide-sidebar li {
        margin-bottom: 4px;
      }

      .styleguide-sidebar a {
        color: #666;
        text-decoration: none;
        display: block;
        padding: 4px 0;
        font-size: 14px;
      }

      .styleguide-sidebar a:hover {
        color: #333;
      }

      .styleguide-sidebar a.active {
        color: #4F46E5;
        font-weight: 500;
      }

      .styleguide-sidebar .example-list {
        margin-left: 16px;
        margin-top: 4px;
      }

      .styleguide-sidebar .example-list a {
        font-size: 13px;
        color: #999;
      }

      .styleguide-sidebar .example-list a.active {
        color: #4F46E5;
        font-weight: 500;
      }

      .styleguide-section {
        margin-bottom: 32px;
      }

      .styleguide-section h2 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 16px;
        color: #333;
      }

      .styleguide-preview {
        background: #ffffff;
        padding: 24px;
        margin-bottom: 24px;
        border-radius: 8px;
        border: 1px solid #e0e0e0;
      }

      .styleguide-code {
        margin-top: 24px;
      }

      .styleguide-code-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
      }

      .styleguide-code h3 {
        font-size: 16px;
        font-weight: 600;
        margin: 0;
        color: #333;
      }

      .styleguide-copy-btn {
        background: #ffffff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        padding: 6px 12px;
        font-size: 13px;
        color: #666;
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 500;
      }

      .styleguide-copy-btn:hover {
        background: #f5f5f5;
        border-color: #4F46E5;
        color: #333;
      }

      .styleguide-copy-btn:active {
        transform: scale(0.98);
      }

      .styleguide-code pre {
        background: #f3f4f6;
        border-radius: 6px;
        padding: 16px;
        overflow-x: auto;
        color: #111827;
        font-size: 14px;
        line-height: 1.5;
        border: 1px solid #e0e0e0;
      }

      .styleguide-code code {
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
        font-size: 14px;
        color: #111827;
      }

      /* CodeRay styles - light theme */
      .CodeRay {
        background-color: #f3f4f6;
        border-radius: 6px;
        padding: 16px;
        overflow: auto;
        color: #111827;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
        font-size: 14px;
        line-height: 1.5;
        border: 1px solid #e0e0e0;
      }

      .CodeRay pre {
        margin: 0;
        color: #111827;
      }

      .CodeRay * {
        color: #111827 !important;
      }

      .styleguide-tabs {
        display: flex;
        margin-bottom: 24px;
        gap: 8px;
        flex-wrap: wrap;
      }

      .styleguide-tab {
        padding: 8px 12px;
        background: #ffffff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        cursor: pointer;
        text-decoration: none;
        color: #666;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
      }

      .styleguide-tab:hover {
        background: #f5f5f5;
        color: #333;
        border-color: #4F46E5;
      }

      .styleguide-tab.active {
        background: #4F46E5;
        border-color: #4F46E5;
        color: #ffffff;
        font-weight: 600;
      }

      .styleguide-main p {
        color: #666;
        line-height: 1.6;
      }
    </style>
  </head>

  <body>
    <div class="styleguide-container">
      <div class="styleguide-sidebar">
        <div class="styleguide-sidebar-header">
          <h2>Components</h2>
        </div>
        <ul>
          <% ViewComponent::Preview.all.reject { |p| p.preview_name == 'component' }.sort_by(&:name).each do |preview| %>
            <li>
              <% is_active = @preview && preview.preview_name == @preview.preview_name %>
              <%= link_to preview_label(preview),
                "/styleguide/#{preview.preview_name}/#{preview.examples.first}",
                class: is_active ? 'active' : '' %>
              <% if preview.examples.any? && is_active %>
                <ul class="example-list">
                  <% preview.examples.each do |example| %>
                    <li>
                      <%= link_to example_label(example),
                        "/styleguide/#{preview.preview_name}/#{example}",
                        class: example == @example_name ? 'active' : '' %>
                    </li>
                  <% end %>
                </ul>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>

      <div class="styleguide-main">
        <% if @preview.present? %>
          <h1><%= preview_label(@preview) %></h1>

          <% if @preview.examples.length > 1 %>
            <div class="styleguide-tabs">
              <% @preview.examples.each do |example| %>
                <%= link_to example_label(example),
                  "/styleguide/#{@preview.preview_name}/#{example}",
                  class: ['styleguide-tab', { 'active': example == @example_name }] %>
              <% end %>
            </div>
          <% end %>

          <%= yield %>
        <% else %>
          <h1>Component Styleguide</h1>
          <p>Select a component from the sidebar to view its preview and code examples.</p>
        <% end %>
      </div>
    </div>
  </body>
</html>

<div class="styleguide-section">
  <h2>Example: <%= example_label(@example_name) %></h2>

  <div class="styleguide-preview">
    <% if @render_args[:component] %>
      <%= render(@render_args[:component], @render_args[:args], &@render_args[:block]) %>
    <% else %>
      <%= render template: @render_args[:template], locals: @render_args[:locals] || {} %>
    <% end %>
  </div>

  <div class="styleguide-code">
    <div class="styleguide-code-header">
      <h3>Code:</h3>
      <% if @preview.respond_to?(:preview_source) && @preview.preview_source(@example_name).present? %>
        <% code_text = @preview.preview_source(@example_name) %>
        <button
          class="styleguide-copy-btn"
          data-controller="copy"
          data-copy-text-value="<%= code_text %>"
          data-action="click->copy#copy"
          type="button">
          ðŸ“‹ Copy
        </button>
      <% end %>
    </div>

    <% if @preview.respond_to?(:preview_source) && @preview.preview_source(@example_name).present? %>
      <%# Ruby method source %>
      <%= CodeRay.scan(@preview.preview_source(@example_name), :ruby).div.html_safe %>
    <% elsif @render_args[:template] %>
      <%# ERB template source %>
      <% template_source = @view_renderer.lookup_context.find_template(@render_args[:template]).source %>
      <%= CodeRay.scan(template_source, :erb).div.html_safe %>
    <% end %>

    <% if @render_args[:component] %>
      <br>
      <div class="styleguide-code-header">
        <h3>Filepath:</h3>
        <% component_path = "app/components/#{@render_args[:component].class.name.underscore.gsub('::', '/')}.rb" %>
        <button
          class="styleguide-copy-btn"
          data-controller="copy"
          data-copy-text-value="<%= component_path %>"
          data-action="click->copy#copy"
          type="button">
          ðŸ“‹ Copy
        </button>
      </div>
      <pre><code><%= component_path %></code></pre>
    <% end %>
  </div>
</div>
